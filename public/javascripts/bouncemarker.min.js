(function(){var e=L.Marker.prototype.onAdd;var t=L.Marker.prototype.onRemove;L.Marker.mergeOptions({bounceOnAdd:false,bounceOnAddOptions:{duration:1e3,height:-1},bounceOnAddCallback:function(){}});L.Marker.include({_toPoint:function(e){return this._map.latLngToContainerPoint(e)},_toLatLng:function(e){return this._map.containerPointToLatLng(e)},_motionStep:function(e){var t=this;var n=new Date;t._intervalId=setInterval(function(){var r=new Date-n;var i=r/e.duration;if(i>1){i=1}var s=e.delta(i);e.step(s);if(i===1){e.end();clearInterval(t._intervalId)}},e.delay||10)},_bounceMotion:function(e,t,n){var r=L.latLng(this._origLatlng),i=this._dropPoint.y,s=this._dropPoint.x,o=this._point.y-i;var u=this;this._motionStep({delay:10,duration:t||1e3,delta:e,step:function(e){u._dropPoint.y=i+o*e-(u._map.project(u._map.getCenter()).y-u._origMapCenter.y);u._dropPoint.x=s-(u._map.project(u._map.getCenter()).x-u._origMapCenter.x);u.setLatLng(u._toLatLng(u._dropPoint))},end:function(){u.setLatLng(r);if(typeof n==="function")n()}})},_easeOutBounce:function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}},bounce:function(e,t){this._origLatlng=this.getLatLng();this._bounce(e,t)},_bounce:function(e,t){if(typeof e==="function"){t=e;e=null}e=e||{duration:1e3,height:-1};if(typeof e==="number"){e.duration=arguments[0];e.height=arguments[1]}this._origMapCenter=this._map.project(this._map.getCenter());this._dropPoint=this._getDropPoint(e.height);this._bounceMotion(this._easeOutBounce,e.duration,t)},_getDropPoint:function(e){this._point=this._toPoint(this._origLatlng);var t;if(e===undefined||e<0){t=this._toPoint(this._map.getBounds()._northEast).y}else{t=this._point.y-e}return new L.Point(this._point.x,t)},onAdd:function(t){this._map=t;this._origLatlng=this._latlng;if(this.options.bounceOnAdd===true){if(typeof this.options.bounceOnAddDuration!=="undefined"){this.options.bounceOnAddOptions.duration=this.options.bounceOnAddDuration}if(typeof this.options.bounceOnAddHeight!=="undefined"){this.options.bounceOnAddOptions.height=this.options.bounceOnAddHeight}this._dropPoint=this._getDropPoint(this.options.bounceOnAddOptions.height);this.setLatLng(this._toLatLng(this._dropPoint))}e.call(this,t);if(this.options.bounceOnAdd===true){this._bounce(this.options.bounceOnAddOptions,this.options.bounceOnAddCallback)}},onRemove:function(e){clearInterval(this._intervalId);t.call(this,e)}})})()